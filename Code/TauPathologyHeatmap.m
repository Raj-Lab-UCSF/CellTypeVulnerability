function TauPathologyHeatmap(datsetnames_,outputs,cmap_,savenclose,figdir_)
if nargin < 5
    figdir_ = cd;
    if nargin < 4
        savenclose = 0;
    end
end

if isempty(cmap_)
    cmap_ = hot(1000);
end

if length(datsetnames_) == 9
    f = figure('Units','inches','Position',[0,0,16,15]);
%     f = figure('Units','inches','Position',[0,0,11,10]);
    tiledlayout(3,3,'TileSpacing','compact','Padding','compact');
elseif length(datsetnames_) == 10
    f = figure('Units','inches','Position',[0,0,20,8]);
else
    f = figure('Units','inches','Position',[0,0,20,15]);
end

% Correlation heatmap
datsetlabels = cellfun(@(x)strrep(x,'_',' '),datsetnames_,'UniformOutput',false);
for i = 1:length(datsetnames_)
    if length(datsetnames_) == 9
%         subplot(3,3,i);
        nexttile;
    elseif length(datsetnames_) == 10
        subplot(2,5,i);
    else
        subplot(1,length(datsetnames_),i);
    end
    corrmat = corr(outputs.(datsetnames_{i}).data,'rows','complete');
    corrlims = [0.5*min(corrmat(:)),1];
    imagesc(corrmat,corrlims); colormap(cmap_); cb = colorbar;
    cbnumticks = 3; cbticks = linspace(corrlims(1),corrlims(2),cbnumticks);
    cbticklabels = cell(1,cbnumticks);
    for j = 1:cbnumticks
        cbticklabels{j} = num2str(cbticks(j),2);
    end
    set(cb,'Ticks',cbticks,'TickLabels',cbticklabels);

    ts = outputs.(datsetnames_{i}).time_stamps;
    labs = cell(1,length(ts));
    for j = 1:length(ts)
        if ~strcmp('DS',datsetnames_{i}(1:2))
            labs{j} = num2str(ts(j));
        else
            labs{j} = num2str(ts(j)/4);
        end
    end
    set(gca,'TickLength',[0 0],'DataAspectRatio',[1 1 1],'XTick',1:length(ts),...
        'XTickLabel',labs,'TickLabelInterpreter','tex',...
        'YTick',1:length(ts),'YTickLabel',labs,'FontName','Times','FontSize',20)
    title(datsetlabels{i},'FontName','Times','FontSize',20);
end
han=axes(f,'visible','off'); 
han.XLabel.Visible='on';
han.YLabel.Visible='on';
ylh = ylabel(han,'Time (Months)','FontSize',24,...
    'FontName','Times','FontWeight','bold');
ylh.Position(1) = ylh.Position(1) - abs(ylh.Position(1) * 2.35);
xlh = xlabel(han,'Time (Months)','FontSize',24,...
    'FontName','Times','FontWeight','bold');
xlh.Position(2) = xlh.Position(2) - abs(xlh.Position(2) * 4);

if savenclose
    print([figdir_ filesep 'CrossCorr_TauopathyData'],'-dtiffn','-r600'); close;
end
end