function Eigenvector3DScatterPlot(V_,subclasses_,eigentype_,cmap_,savenclose_,figdir_)

if length(subclasses_) == 42
    nonneuronal_inds = find(ismember(subclasses_,{'Endo','Astro','Oligo',...
        'Micro-PVM','SMC-Peri','VLMC'}));
    gaba_inds = find(ismember(subclasses_,{'Lamp5','Sncg','Meis2','CR',...
        'Pvalb','Sst','Sst Chodl','Vip'}));
    glutctx_other_inds = find(ismember(subclasses_,{'Car3','L4 RSP-ACA'}));
    ctxtest = @(x) strcmp(x(end),'X');
    glutctx_inds = find(logical(cell2mat(cellfun(ctxtest,subclasses_,'UniformOutput',false))));
    glutctx_inds = sort([glutctx_other_inds; glutctx_inds]);
    gluthipp_inds = setdiff((1:length(subclasses_)).',[nonneuronal_inds;gaba_inds;glutctx_inds]);
    indcell = {glutctx_inds,gluthipp_inds,gaba_inds,nonneuronal_inds};
    % indtest = [glutctx_inds;gluthipp_inds;gaba_inds;nonneuronal_inds];
    if strcmp(cmap_,'cool')
        cmap_labs = cool(length(indcell));
    elseif strcmp(cmap_,'hsv')
        cmap_labs = hsv(length(indcell));
    elseif strcmp(cmap_,'lines')
        cmap_labs = lines(length(indcell));
    else
        cmap_labs = twocolor(cmap_(1,:),cmap_(2,:),length(indcell));
    end
else
    if strcmp(cmap_,'cool')
        cmap_labs = cool(size(corrmat_ct_,1));
    elseif strcmp(cmap_,'hsv')
        cmap_labs = hsv(size(corrmat_ct_,1));
    elseif strcmp(cmap_,'lines')
        cmap_labs = lines(size(corrmat_ct_,1));
    else
        cmap_labs = twocolor(cmap_(1,:),cmap_(2,:),length(subclasses_));
    end
    % indtest = 1:length(subclasses_);
    indcell = cell(1,length(subclasses_));
    for i = 1:length(indcell)   
        indcell{i} = i;
    end
end

V4 = V_(:,4); V2 = V_(:,2); V3 = V_(:,3);

cmap_ = cmap_labs;
figure('Units','inches','Position',[0 0 8 8]); hold on;
for i = 1:size(cmap_,1)
    ct_inds = indcell{i};
    scatter3(V2(ct_inds),V3(ct_inds),V4(ct_inds),...
        75,cmap_(i,:),'filled');
end
if strcmp(eigentype_,'MRx3')
    eigentype_str = 'L_g_e_n_e';
elseif strcmp(eigentype_,'Spatial')
    eigentype_str = 'L_s_p_a_t_i_a_l';
end
xlabel('v_2'); ylabel('v_3'); zlabel('v_4'); title(eigentype_str);
view([135,35.2644]);
set(gca,'FontSize',24,'FontName','Times','box','on');
if savenclose_
    figstr = [figdir_ filesep '3d_scatter_' eigentype_];
    print(figstr,'-dtiffn','-r600'); close;
end
end