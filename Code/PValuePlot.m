function PValuePlot(logpmat_,datsetnames_,subclasses_,type,cmap_,savenclose,figdir_)
if nargin < 7
    figdir_ = cd;
    if nargin < 6
        savenclose = 0;
        if nargin < 5
            cmap_ = hot(1000);
        end
    end
end

datsetlabels = cellfun(@(x)strrep(x,'_',' '),datsetnames_,'UniformOutput',0);

figure('Units','inches','Position',[0 0 25 8])
imagesc(logpmat_,[0,10]); colormap(cmap_); colorbar;
set(gca,'TickLength',[0 0],'DataAspectRatio',[1 1 1],'XTick',1:length(subclasses_),...
    'XTickLabelRotation',90,'XTickLabel',subclasses_,...
    'YTick',1:length(datsetnames_),'YTickLabel',datsetlabels,'FontName','Times','FontSize',20)
if strcmp(type,'Pearson')
    title("-log_1_0(p-value), Pearson's R");
    figstr = 'PValuePlot_Pearson_';
elseif strcmp(type,'Partial')
    title("-log_1_0(p-value), Partial Correlation \rho")    
    figstr = 'PValuePlot_Partial_';
end
if length(subclasses_) == 25
    figstr = [figstr 'Tasic'];
elseif length(subclasses_) == 42
    figstr = [figstr 'Yao'];
end
if savenclose
    print([figdir_ filesep figstr],'-dtiffn','-r600'); close;
end
end