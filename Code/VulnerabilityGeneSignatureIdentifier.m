function [vuln_genes,vuln_score] = VulnerabilityGeneSignatureIdentifier(corrmat_,...
    genemat_,genenames_,ngenes_,thresh_,stdweight_)

path_metric = mean(corrmat_) ./ std(corrmat_).^(stdweight_);

ctmean = mean(genemat_,1);
ctmean = repmat(ctmean,size(genemat_,1),1);
ctnorm = genemat_ ./ ctmean;
C_cellnorm = ctnorm;
zeroinds = false(1,size(C_cellnorm,1));
for i = 1:length(zeroinds)
    zeroinds(i) = all(C_cellnorm(i,:) == 0);
end
C_cellnorm(zeroinds,:) = [];
genenames_(zeroinds) = [];

lowexprinds = (sum(C_cellnorm,2) < (thresh_*median(sum(C_cellnorm,2))));
C_cellnorm(lowexprinds,:) = [];
genenames_(lowexprinds) = [];

C_mean = mean(C_cellnorm,2);
C_std = std(C_cellnorm,[],2);
zscore_mat = (C_cellnorm - repmat(C_mean,1,size(C_cellnorm,2)))./...
    repmat(C_std,1,size(C_cellnorm,2));
vuln_score = zscore_mat * path_metric.';
[~,sortinds] = sort(vuln_score,'descend');
vuln_genes = genenames_(sortinds(1:ngenes_));

end