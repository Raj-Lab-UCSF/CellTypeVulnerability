function CellTypeFrequencyPlot(subclasses_,subclasses_sig_,datasource,isbic,cmap_,savenclose,figdir_)
if nargin < 7
    figdir_ = cd;
    if nargin < 6
        savenclose = 0;
        if nargin < 5
            cmap_ = [[0 0.75 1]; [1 0 0.5]];
        end
    end
end

subclasses_1d = {};
ndatsets = length(subclasses_sig_);
for i = 1:ndatsets
    subclasses_1d = [subclasses_1d, subclasses_sig_{i}.']; %#ok<AGROW> 
end
subclasses_sig = unique(subclasses_1d);
ctfreq = zeros(1,length(subclasses_sig));
for i = 1:length(ctfreq)
    ctfreq(i) = sum(ismember(subclasses_1d,subclasses_sig{i}));
end
[ctfreq_sort,sortinds] = sort(ctfreq,'descend');
subsigs_sort = subclasses_sig(sortinds);

if strcmp(datasource,'Tasic')
%   Fill in later
elseif strcmp(datasource,'Yao')
    nonneuronal_inds = ismember(subclasses_,{'Endo','Astro','Oligo',...
        'Micro-PVM','SMC-Peri','VLMC'});
    gaba_inds = ismember(subclasses_,{'Lamp5','Sncg','Meis2','CR',...
        'Pvalb','Sst','Sst Chodl','Vip'});
    ctxtest = @(x) strcmp(x(end),'X');
    glutctx_inds = logical(cell2mat(cellfun(ctxtest,subclasses_,'UniformOutput',false)));
    gluthipp_inds = ~logical(nonneuronal_inds + gaba_inds + glutctx_inds);
    indcell = {glutctx_inds,gluthipp_inds,gaba_inds,nonneuronal_inds};
    indtest = glutctx_inds + 2*gluthipp_inds + 3*gaba_inds + 4*nonneuronal_inds;
end
cmap_ = twocolor(cmap_(1,:),cmap_(2,:),length(indcell));
cmap_label = zeros(length(indtest),3);
for i = 1:length(indtest)
    cmap_label(i,:) = cmap_(indtest(i),:);
end

figure('Units','inches','Position',[0 0 14 8]); 
b = bar(ctfreq_sort/ndatsets,'EdgeColor',[0.25 0.25 0.25],'LineWidth',1);
b.FaceColor = 'flat';
if isbic
    ylabel('Selection Frequency, BIC','FontWeight','bold'); 
else
    nsigtypes = length(subclasses_sig_{1});
    ylabel(sprintf('Selection Frequency, Top %d',nsigtypes),'FontWeight','bold');
end
xlabs = cell(1,length(subsigs_sort));
for i = 1:length(subsigs_sort)
    col = cmap_label(ismember(subclasses_,subsigs_sort{i}),:);
    xlabs{i} = sprintf('\\color[rgb]{%f,%f,%f}%s',col(1),col(2),col(3),subsigs_sort{i});
    b.CData(i,:) = col;
end
maxy = max(ctfreq/ndatsets);
set(gca,'XTick',1:length(subsigs_sort),'XTickLabel',xlabs,'TickLength',[0 1],...
    'YTick',[0 maxy/2 maxy],'YTickLabel',{'0',num2str(maxy/2,'%.2f'),...
    num2str(maxy,'%.2f')},'TickLabelInterpreter','tex','FontName','Times','FontSize',20);

if savenclose
    if isbic
        print([figdir_ filesep 'CellTypeFrequencyPlot_BIC_' datasource],'-dtiffn','-r600'); close;
    else
        print([figdir_ filesep sprintf('CellTypeFrequencyPlot_Top%d_%s',nsigtypes,datasource)],'-dtiffn','-r600'); close;
    end
end
end