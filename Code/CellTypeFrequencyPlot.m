function CellTypeFrequencyPlot(subclasses_,subclasses_sig_,tpt_,datasource,isbic,cmap_,savenclose,figdir_)
if nargin < 8
    figdir_ = cd;
    if nargin < 7
        savenclose = 0;
        if nargin < 6
            cmap_ = [[0 0.75 1]; [1 0 0.5]];
        end
    end
end

subclasses_1d = {};
ndatsets = length(subclasses_sig_);
for i = 1:ndatsets
    subclasses_1d = [subclasses_1d, subclasses_sig_{i}.']; %#ok<AGROW> 
end
subclasses_sig = unique(subclasses_1d);
ctfreq = zeros(1,length(subclasses_sig));
for i = 1:length(ctfreq)
    ctfreq(i) = sum(ismember(subclasses_1d,subclasses_sig{i}));
end
[ctfreq_sort,sortinds] = sort(ctfreq,'descend');
subsigs_sort = subclasses_sig(sortinds);

if strcmp(datasource,'Tasic')
%   Fill in later
elseif strcmp(datasource,'Yao')
    nonneuronal_inds = ismember(subclasses_,{'Endo','Astro','Oligo',...
        'Micro-PVM','SMC-Peri','VLMC'});
    gaba_inds = ismember(subclasses_,{'Lamp5','Sncg','Meis2','CR',...
        'Pvalb','Sst','Sst Chodl','Vip'});
    ctxtest = @(x) strcmp(x(end),'X');
    glutctx_inds = logical(cell2mat(cellfun(ctxtest,subclasses_,'UniformOutput',false)));
    gluthipp_inds = ~logical(nonneuronal_inds + gaba_inds + glutctx_inds);
    indcell = {glutctx_inds,gluthipp_inds,gaba_inds,nonneuronal_inds};
    indtest = glutctx_inds + 2*gluthipp_inds + 3*gaba_inds + 4*nonneuronal_inds;
end
cmap_ = twocolor(cmap_(1,:),cmap_(2,:),length(indcell));
cmap_label = zeros(length(indtest),3);
for i = 1:length(indtest)
    cmap_label(i,:) = cmap_(indtest(i),:);
end

figure('Units','inches','Position',[0 0 8 10]); 
b = barh(ctfreq_sort/ndatsets,'EdgeColor',[0.25 0.25 0.25],'LineWidth',1);
b.FaceColor = 'flat';
ylabs = cell(1,length(subsigs_sort));
for i = 1:length(subsigs_sort)
    col = cmap_label(ismember(subclasses_,subsigs_sort{i}),:);
    ylabs{i} = sprintf('\\color[rgb]{%f,%f,%f}%s',col(1),col(2),col(3),subsigs_sort{i});
    b.CData(i,:) = col;
end
maxx = max(ctfreq/ndatsets);
xlabel('')
set(gca,'YTick',1:length(subsigs_sort),'YTickLabel',ylabs,'TickLength',[0 1],...
    'XTick',[0 maxx/2 maxx],'XTickLabel',{'0',num2str(maxx/2,'%.2f'),...
    num2str(maxx,'%.2f')},'TickLabelInterpreter','tex','FontName',...
    'Times','FontSize',20,'YDir','reverse');
if isbic
    xlabel('Selection Frequency, BIC','FontWeight','bold','FontName','Times','FontSize',24); 
else
    nsigtypes = length(subclasses_sig_{1});
    xlabel(sprintf('Selection Frequency, Top %d',nsigtypes),'FontWeight','bold','FontName','Times','FontSize',24);
end
if savenclose
    if isbic
        print([figdir_ filesep 'CellTypeFrequencyPlot_BIC_' datasource '_t' num2str(tpt_)],'-dtiffn','-r600'); close;
    else
        print([figdir_ filesep sprintf('CellTypeFrequencyPlot_Top%d_%s_%d',nsigtypes,datasource,tpt_)],'-dtiffn','-r600'); close;
    end
end
end